{
  "url": "https://fastapi.tiangolo.com/advanced/openapi-webhooks/",
  "title": "OpenAPI Webhooks¶",
  "content": "There are cases where you want to tell your API users that your app could call their app (sending a request) with some data, normally to notify of some type of event.\n\nThis means that instead of the normal process of your users sending requests to your API, it's your API (or your app) that could send requests to their system (to their API, their app).\n\nThis is normally called a webhook.\n\nThe process normally is that you define in your code what is the message that you will send, the body of the request.\n\nYou also define in some way at which moments your app will send those requests or events.\n\nAnd your users define in some way (for example in a web dashboard somewhere) the URL where your app should send those requests.\n\nAll the logic about how to register the URLs for webhooks and the code to actually send those requests is up to you. You write it however you want to in your own code.\n\nWith FastAPI, using OpenAPI, you can define the names of these webhooks, the types of HTTP operations that your app can send (e.g. POST, PUT, etc.) and the request bodies that your app would send.\n\nThis can make it a lot easier for your users to implement their APIs to receive your webhook requests, they might even be able to autogenerate some of their own API code.\n\nWebhooks are available in OpenAPI 3.1.0 and above, supported by FastAPI 0.99.0 and above.\n\nWhen you create a FastAPI application, there is a webhooks attribute that you can use to define webhooks, the same way you would define path operations, for example with @app.webhooks.post().\n\nThe webhooks that you define will end up in the OpenAPI schema and the automatic docs UI.\n\nThe app.webhooks object is actually just an APIRouter, the same type you would use when structuring your app with multiple files.\n\nNotice that with webhooks you are actually not declaring a path (like /items/), the text you pass there is just an identifier of the webhook (the name of the event), for example in @app.webhooks.post(\"new-subscription\"), the webhook name is new-subscription.\n\nThis is because it is expected that your users would define the actual URL path where they want to receive the webhook request in some other way (e.g. a web dashboard).\n\nNow you can start your app and go to http://127.0.0.1:8000/docs.\n\nYou will see your docs have the normal path operations and now also some webhooks:",
  "headings": [
    {
      "level": "h1",
      "text": "OpenAPI Webhooks¶",
      "id": "openapi-webhooks"
    },
    {
      "level": "h2",
      "text": "Webhooks steps¶",
      "id": "webhooks-steps"
    },
    {
      "level": "h2",
      "text": "Documenting webhooks with FastAPI and OpenAPI¶",
      "id": "documenting-webhooks-with-fastapi-and-openapi"
    },
    {
      "level": "h2",
      "text": "An app with webhooks¶",
      "id": "an-app-with-webhooks"
    },
    {
      "level": "h3",
      "text": "Check the docs¶",
      "id": "check-the-docs"
    }
  ],
  "code_samples": [
    {
      "code": "from datetime import datetime\n\nfrom fastapi import FastAPI\nfrom pydantic import BaseModel\n\napp = FastAPI()\n\n\nclass Subscription(BaseModel):\n    username: str\n    monthly_fee: float\n    start_date: datetime\n\n\n@app.webhooks.post(\"new-subscription\")\ndef new_subscription(body: Subscription):\n    \"\"\"\n    When a new user subscribes to your service we'll send you a POST request with this\n    data to the URL that you register for the event `new-subscription` in the dashboard.\n    \"\"\"\n\n\n@app.get(\"/users/\")\ndef read_users():\n    return [\"Rick\", \"Morty\"]",
      "language": "python"
    }
  ],
  "patterns": [],
  "links": [
    "https://fastapi.tiangolo.com/advanced/openapi-webhooks/"
  ]
}