# Phase 1/2 UI Wireframe 規劃

## 主視圖（Traffic Canvas）
```
┌───────────────────────────────────────────┐
│ Header: 選擇資料來源｜重整｜播放控制        │
├───────────────────────────────────────────┤
│ 協議圖層面板（左）  │ 連線動畫舞台（右） │
│ ‧ TCP 握手            │ 1. 主要連線以水平軸展示 │
│ ‧ TCP 揮手            │ 2. 顏色依協議變化       │
│ ‧ HTTP 往返           │ 3. 事件標籤浮於節點上方 │
│ ‧ Timeout             │ 4. 右上角顯示延遲統計   │
│ ‧ DNS / UDP / ICMP    │                        │
│ ‧ TLS Handshake       │                        │
└───────────────────────────────────────────┘
```
- 左側面板提供層級開關與圖例，與 `protocolStates` 一致。
- 舞台具備縮放（滾輪/觸控板）與拖曳移動；Phase 1 先提供固定倍率。
- 事件標籤（SYN、ACK、FIN、200 OK 等）使用 Pill 樣式，隨 stage 進場淡入。

## 時間軸控制（底部 Dock）
```
┌───────────────────────────────────────────┐
│ ?? │ ? │ ● │ ? │ ?? │ 速度: 1× │ 00:00 / 00:05 │
│───────────────────────────────────────────│
│?????●??????????△????○?????╳??????           │
└───────────────────────────────────────────┘
```
- 進度條顯示目前 `elapsedMs / totalDuration`，重要節點（Handshake 完成、Timeout 觸發）以 `△/╳` 標記。
- 拖曳圓點觸發 `seek()`，並同步更新細節窗。
- 速度選單支援 0.5×、1×、2×，對應動畫控制器的 `setPlaybackSpeed`。

## 連線詳情抽屜（右側 Slide-over）
```
┌───────────────────────────────┐
│ Connection Details             │
│ 10.1.1.14:52344 → 20.57.1.8:443│
├───────────────────────────────┤
│ 協議階段時間                   │
│ ‧ SYN sent ............ 0.0ms  │
│ ‧ SYN-ACK received ..... 24.1ms│
│ ‧ ACK sent ............. 44.3ms│
│--------------------------------│
│ 指標摘要                       │
│ RTT: 44.3ms | Retries: 1       │
│ 狀態碼: 200 OK                 │
│--------------------------------│
│ 行動按鈕                       │
│ [匯出封包] [標記為異常]        │
└───────────────────────────────┘
```
- 由舞台點擊節點或時間軸事件開啟。
- 顯示 `ProtocolTimeline.metrics` 與對應封包序列。
- 行動按鈕 stub：Phase 1 可先禁用，顯示「即將推出」。

## 警示卡與通知列
```
┌───────────────┐  ┌───────────────┐
│ ?? SYN Flood?  │  │ ?? DNS Anomaly │
│ 120 SYN/s 無 ACK │ │ 單一網域 65 req │
│ [檢視細節]      │ │ [加入標籤]     │
└───────────────┘  └───────────────┘
```
- 置於舞台右上角堆疊顯示，最多 3 張，餘下收合至通知面板。
- 點擊後聚焦到對應 timeline（呼叫 `seek()` + `highlight`）。
- Phase 1 先顯示 Timeout 警示（紅色卡片），Phase 2 才串異常規則。

## 互動流程摘要
1. 使用者匯入或載入預設分析 → 主視圖以 TCP/HTTP 連線開場。
2. 播放控制觸發 `advance()`，節點與標籤依序呈現；時間軸同步移動。
3. 使用者點擊節點 → 右側抽屜顯示詳細資訊與封包列表。
4. 若偵測 Timeout → 警示卡顯示，使用者點擊後跳至 Timeout 事件。
5. 使用者可切換協議層級或調整播放速度觀察其他協議。

## 與動畫邏輯協作需求
- 主舞台需接收 `ProtocolAnimationController.getRenderableState()`，以確定節點位置與顏色。
- 時間軸與播放控制要能呼叫 controller 的 `advance/seek/setPlaybackSpeed`。
- 詳情抽屜需取得 `currentStage.packetRefs` 以顯示對應封包編號。
- 警示卡資料格式由 `ProtocolTimeline.anomalyTags` 衍生，需在 Phase 1 預留欄位。

## 後續工作清單
- 建立 Figma/Whimsical 線框（責任：UI/UX）→ 與前端/動畫工程師共評。
- 定義 CSS token：顏色、陰影、卡片邊框以 tailwind plugin 或 CSS module 呈現。
- 協作介面：撰寫 `useProtocolAnimation(timeline)` hook，包裝 controller 與 React state。
- 可存取性：提醒為事件標籤與警示卡提供 ARIA label 與鍵盤操作流程。
